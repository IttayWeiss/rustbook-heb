## קריאת קובץ

כעת נוסיף פונקציונאליות לקריאת הקובץ המצויין בארגומנט `file_path`. ראשית, אנו זקוקים לקובץ כדוגמא שנוכל לבחון באמצעותו את הקוד שלנו: אנו נשתמש בקובץ עם מעט טקסט בכמה שורות ועם כמה מילים שחוזרות על עצמן. רשימה 12-3 היא שיר של אמילי דיקינסון והוא ישרת את מטרתנו נאמנה! צרו קובץ בשם _poem.txt_ בבסיס הפרוייקט שלכם, והקלידו את השיר “I’m Nobody!
Who are you?”

<span class="filename">Filename: poem.txt</span>

```text
{{#include ../listings/ch12-an-io-project/listing-12-03/poem.txt}}
```

<span class="caption">רשימה 12-3: שיר של אמילי דיקינסון שמהווה מקרה-מבחן נוח</span>

כעת שהטקסט במקומו, ערכו את _src/main.rs_ והוסיפו את הקוד כמופיע ברשימה 12-4.

<span class="filename">Filename: src/main.rs</span>

```rust,should_panic,noplayground
{{#rustdoc_include ../listings/ch12-an-io-project/listing-12-04/src/main.rs:here}}
```

<span class="caption">רשימה 12-4: קריאת תוכן הקובץ המופיע כארגומנט השני</span>

קודם כל, אנו מכניסים למתחם את החלק הרלוונטי מהספריה הסטנדרטית בעמצאות פקודת `use`: אנו צריכים את `std::fs` כדי לנהל קבצים.

בפונקציה `main`, הפקודה החדשה `fs::read_to_string` לוקחת את `file_path`, פותחת את הקובץ, ומחזירה ערך מטיפוס `std::io::Result<String>` של תוכן הקובץ.

לאחר מכן, אנו מוסיפים פקודת `println!` זמנית שמדפיסה את הערך של `contents` לאחר קריאת הקובץ, כדי שנוכל לבדוק שהתכנית עושה את הדרוש.

הבה נריץ את הקוד עם סתם מחרוזת כלשהיא עבור הארגומנט הראשון (כיוון שעוד לא מימשנו את את פעולת החיפוש) ועם _poem.txt_ עבור הארגומנט השני:

```console
{{#rustdoc_include ../listings/ch12-an-io-project/listing-12-04/output.txt}}
```

מצויין! הקוד קורא ומדפיס את תוכן הקובץ. אבל לקוד יש כמה מגרעות. בשלב זה, לפונקציה `main` אחראית לכמה דברים: באופן כללי, קל יותר לקרוא ולתחזק פונקציות אם כל פונקציה אחראית לבצע רק משהו אחד. הבעיה השניה היא שאנו לא מטפלים בשגיאות בצורה נאותה. התכנית עדיין קצרה, ולכן בעיות אלה אינן גדולות, אבל ככל שהתכנית תגדל, יהיה קשה יותר לתקן אותן בצורה נקיה. מומלץ לבצע ארגון מחדש של הקוד בשלב מוקדם בתהליך הפיתוח, שכן אז קל הרבה יותר לבצע ארגון מחדש של פיסות הקוד השונות, בעודן קטנות. נעשה זאת מייד.
